wafs:
  - name: cloudflare
    headers_any: ["cf-ray", "cf-cache-status", "server:\s*cloudflare", "server:\s*cloudflare-nginx", "expect-ct:\s*max-age=\d+,\s*report-uri"]
    cookies_any: ["__cf_bm", "cf_chl_", "cf_clearance", "__cfduid", "cf_use_ob", "cf_ob_info"]
    body_regex: ["Attention Required!\s*\|\s*Cloudflare", "Please enable JavaScript", "Checking your browser before accessing", "DDoS protection by Cloudflare", "Ray ID:", "cloudflare Ray ID", "jschl-answer", "sucuri.*cloudproxy", "challenge.*js", "a = document", "t\.value = s", "setTimeout.*function", "Recaptcha\.create", "grecaptcha\.render"]
    status_any: [403, 503, 520, 521, 522, 523, 524, 525, 526]
    challenge_signals: ["cf-chl-", "cf-ray", "jschl-answer", "a = document", "t\.value = s", "setTimeout.*function"]
    challenge: "js"
    notes: "Cloudflare IUAM/JS challenge"
    safe_rps: 0.5
    backoff_ms: 3000
    header_camo: true
    rotate_ua: true
    reduce_inline_handlers: true
    no_javascript_url: true
  - name: cloudfront
    headers_any: ["via:\s*1\.1\s*.*cloudfront", "x-amz-cf-", "server:\s*cloudfront", "x-cache:\s*.*cloudfront", "x-amz-request-id"]
    cookies_any: []
    body_regex: ["CloudFront", "The request could not be satisfied", "Generated by cloudfront", "Request blocked", "WebACL", "AWS"]
    status_any: [403, 400, 404, 405, 418, 429, 499, 500, 502, 503, 504]
    challenge_signals: []
    challenge: "none"
    notes: "CloudFront/Shield"
    safe_rps: 1.0
    trust_proxy: true
    backoff_ms: 2000
  - name: akamai
    headers_any: ["akamai", "x-akamai-", "server: AkamaiGHost", "x-ak-uuid", "x-akamai-session-continuity", "x-check-cacheable"]
    cookies_any: ["ak_bmsc", "abck", "bm_sv", "bm_mi", "akacd_"]
    body_regex: ["AkamaiGHost", "Access Denied", "Request ID:", "akamai", "Akamai Bot Manager", "Akamai Edge"]
    status_any: [403, 400, 405, 418, 429, 499, 500, 502, 503, 504]
    challenge_signals: ["ak_bmsc", "abck", "bm_sv", "bm_mi"]
    challenge: "js"
    notes: "Akamai Bot Manager/Edge"
    safe_rps: 0.8
    header_camo: true
    reduce_inline_handlers: true
    backoff_ms: 2500
  - name: imperva
    headers_any: ["x-iinfo", "x-cdn", "x-provided-by", "x-via-imperva"]
    cookies_any: ["visid_incap_", "nlbi_", "incap_ses_", "waf_sess_"]
    body_regex: ["Request\s+blocked", "Incapsula", "incident id", "inCAP", "Visiting\s+from\s+a\s+new\s+location", "Security\s+check", "Checking\s+your\s+browser", "Please\s+turn\s+JavaScript\s+on", "enable\s+JavaScript"]
    status_any: [403, 500, 502, 503, 504]
    challenge_signals: ["_Incapsula_Resource", "visid_incap", "nlbi_", "incap_ses_"]
    challenge: "js"
    notes: "Imperva/Incapsula"
    safe_rps: 0.7
    header_camo: true
    reduce_inline_handlers: true
    no_javascript_url: true
    backoff_ms: 3000
  - name: aws_waf
    headers_any: ["x-amzn-RequestId", "x-amzn-ErrorType", "x-amz-", "server:.*AWS", "server:.*ECS"]
    cookies_any: []
    body_regex: ["Request\s+blocked", "AWS", "WebACL", "Rule ID", "WAF", "Access Denied"]
    status_any: [403, 400, 405, 418, 429, 499, 500, 502, 503, 504]
    challenge_signals: []
    challenge: "none"
    notes: "AWS WAF"
    safe_rps: 1.0
    reduce_inline_handlers: true
    no_javascript_url: true
    backoff_ms: 1500
  - name: azure_waf
    headers_any: ["x-azure-ref", "x-ms-request-id", "server:.*Microsoft", "server:.*IIS"]
    cookies_any: []
    body_regex: ["Azure", "Request\s+blocked", "Web Application Firewall", "WAF", "Microsoft"]
    status_any: [403, 400, 405, 418, 429, 499, 500, 502, 503, 504]
    challenge_signals: []
    challenge: "none"
    notes: "Azure Front Door/WAF"
    safe_rps: 1.2
    backoff_ms: 2000
  - name: bigip_asm
    headers_any: ["big-ip", "x-wa-info", "x-asm-version", "server:.*BigIP", "server:.*F5"]
    cookies_any: ["BIGipServer", "MRHSession", "JSESSIONID", "ASPSESSION"]
    body_regex: ["BigIP", "F5", "Request\s+Rejected", "ASM", "Web Application Firewall", "Access Denied"]
    status_any: [403, 400, 405, 418, 429, 499, 500, 502, 503, 504]
    challenge_signals: ["BIGipServer", "MRHSession"]
    challenge: "none"
    notes: "F5 BIG-IP ASM"
    header_camo: true
    backoff_ms: 2000
  - name: barracuda
    headers_any: ["barracuda", "bn-reqid", "x-barracuda", "server:.*Barracuda"]
    cookies_any: ["BNI__BARRACUDA_LM", "BNI_persistence", "BNI_s_", "BNIS_", "BNI_ab_"]
    body_regex: ["Barracuda", "Security\s+Response", "Access Denied", "Request\s+Blocked", "Web Application Firewall"]
    status_any: [403, 400, 405, 418, 429, 499, 500, 502, 503, 504]
    challenge_signals: ["BNI__BARRACUDA_LM", "BNI_persistence", "BNIS_"]
    challenge: "none"
    notes: "Barracuda WAF"
    header_camo: true
    backoff_ms: 2000
  - name: sucuri
    headers_any: ["x-sucuri-id", "server: Sucuri/Cloudproxy", "x-sucuri", "server:.*Sucuri"]
    cookies_any: ["sucuri_cloudproxy_uuid_", "sucuri_session"]
    body_regex: ["Sucuri WebSite Firewall", "Access Denied", "Request blocked", "CloudProxy", "sucuri\.net", "Sucuri WAF"]
    status_any: [403, 400, 405, 418, 429, 499, 500, 502, 503, 504]
    challenge_signals: ["sucuri_cloudproxy_uuid_", "sucuri_session"]
    challenge: "js"
    notes: "Sucuri"
    safe_rps: 0.9
    header_camo: true
    backoff_ms: 2500
  - name: stackpath
    headers_any: ["server: StackPath", "x-sp-gateway", "x-sp-server"]
    cookies_any: []
    body_regex: ["StackPath", "Request blocked", "Access Denied", "Web Application Firewall"]
    status_any: [403, 400, 405, 418, 429, 499, 500, 502, 503, 504]
    challenge_signals: []
    challenge: "none"
    notes: "StackPath"
    header_camo: true
    backoff_ms: 2000
  - name: fastly
    headers_any: ["via:.*fastly", "x-served-by", "x-cache", "x-fastly-request-id", "server:.*fastly"]
    cookies_any: []
    body_regex: ["Fastly", "Request blocked", "Access Denied", "Origin DNS error"]
    status_any: [403, 400, 405, 418, 429, 499, 500, 502, 503, 504, 508]
    challenge_signals: []
    challenge: "none"
    notes: "Fastly"
    trust_proxy: true
    backoff_ms: 1500
  - name: naxsi
    headers_any: ["x-naxsi-verbose", "x-naxsi-match"]
    cookies_any: []
    body_regex: ["NAXSI", "Request blocked", "Rule", "NSM", "naxsi"]
    status_any: [403, 400, 405, 418, 429, 499, 500, 502, 503, 504]
    challenge_signals: ["x-naxsi-verbose"]
    challenge: "none"
    notes: "NAXSI"
    backoff_ms: 1500
  - name: sophos
    headers_any: ["server:.*Sophos", "x-sophos-"]
    cookies_any: []
    body_regex: ["Sophos", "UTM", "Web Application Firewall", "Request blocked", "Access Denied"]
    status_any: [403, 400, 405, 418, 429, 499, 500, 502, 503, 504]
    challenge_signals: []
    challenge: "none"
    notes: "Sophos UTM"
    backoff_ms: 1500
  - name: modsecurity
    headers_any: ["server:.*ModSecurity", "x-modsecurity", "x-mod-sec-message"]
    cookies_any: []
    body_regex: ["access\s+denied\s+by\s+modsecurity", "ModSecurity", "Request blocked", "ModSecurity Action", "Access Denied", "Web Application Firewall"]
    status_any: [403, 400, 405, 418, 429, 499, 500, 502, 503, 504]
    challenge_signals: ["ModSecurity"]
    challenge: "none"
    notes: "ModSecurity/OWASP CRS"
    reduce_inline_handlers: true
    backoff_ms: 1500
  - name: dosarrest
    headers_any: ["server:.*dosarrest", "x-dosarrest"]
    cookies_any: []
    body_regex: ["DOSarrest", "Internet Security", "Access Denied", "Request blocked"]
    status_any: [403, 400, 405, 418, 429, 499, 500, 502, 503, 504]
    challenge_signals: ["dosarrest"]
    challenge: "none"
    notes: "DOSarrest Internet Security"
    backoff_ms: 2000
  - name: comodo
    headers_any: ["server:.*Protected by COMODO", "x-cdn"]
    cookies_any: ["__comodo_cdn"]
    body_regex: ["COMODO", "Protected by", "Access Denied", "Request blocked", "Web Application Firewall"]
    status_any: [403, 400, 405, 418, 429, 499, 500, 502, 503, 504]
    challenge_signals: ["__comodo_cdn"]
    challenge: "none"
    notes: "Comodo cWatch"
    header_camo: true
    backoff_ms: 2000
  - name: kona
    headers_any: ["server:.*AkamaiGHost", "x-kona-"]
    cookies_any: ["ak_bmsc", "abk"]
    body_regex: ["Akamai", "Kona", "Request blocked", "Access Denied", "Web Application Firewall"]
    status_any: [403, 400, 405, 418, 429, 499, 500, 502, 503, 504]
    challenge_signals: ["ak_bmsc", "abk"]
    challenge: "js"
    notes: "Akamai Kona Site Defender"
    header_camo: true
    reduce_inline_handlers: true
    backoff_ms: 2500
  - name: securesphere
    headers_any: ["server:.*SecureSphere", "x-securesphere"]
    cookies_any: []
    body_regex: ["SecureSphere", "Web Application Firewall", "Request blocked", "Access Denied"]
    status_any: [403, 400, 405, 418, 429, 499, 500, 502, 503, 504]
    challenge_signals: ["SecureSphere"]
    challenge: "none"
    notes: "Imperva SecureSphere"
    header_camo: true
    backoff_ms: 2000
  - name: appwall
    headers_any: ["server:.*AppWall", "x-appwall"]
    cookies_any: ["APPWALL_"]
    body_regex: ["Radware", "AppWall", "Application Firewall", "Request blocked", "Access Denied"]
    status_any: [403, 400, 405, 418, 429, 499, 500, 502, 503, 504]
    challenge_signals: ["APPWALL_"]
    challenge: "none"
    notes: "Radware AppWall"
    header_camo: true
    backoff_ms: 2000
  - name: netcontinuum
    headers_any: ["server:.*NetContinuum", "x-nc"]
    cookies_any: ["NCI__SessionId"]
    body_regex: ["NetContinuum", "Barracuda Networks", "Web Application Firewall", "Request blocked", "Access Denied"]
    status_any: [403, 400, 405, 418, 429, 499, 500, 502, 503, 504]
    challenge_signals: ["NCI__SessionId"]
    challenge: "none"
    notes: "NetContinuum WAF"
    header_camo: true
    backoff_ms: 2000